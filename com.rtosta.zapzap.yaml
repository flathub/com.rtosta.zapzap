app-id: com.rtosta.zapzap
runtime: org.kde.Platform
runtime-version: "6.2"
sdk: org.kde.Sdk
base: io.qt.qtwebengine.BaseApp
base-version: "6.2"
comamnd: zapzap
finish-args:
  - "--share=ipc"
  - "--socket=x11"
  - "--socket=pulseaudio"
  - "--socket=system-bus"
  - "--socket=session-bus"
  - "--share=network"
  - "--filesystem=xdg-download"
  - "--device=dri"
  - "--device=all"
  - "--env=QTWEBENGINEPROCESS_PATH=/app/bin/QtWebEngineProcess"
  - "--talk-name=org.kde.StatusNotifierWatcher"
cleanup:
  - /include
  - /lib/pkgconfig
  - "*.la"
  - "*.a"
modules:       
  - pyqt6.yml
  - pyqt6-webengine.yml
  - name: dbus
    buildsystem: simple
    build-options:
      build-args:
      - --share=network
    build-commands:
      - pip3 install dbus-python --prefix=${FLATPAK_DEST} 
  - name: zapzap
    buildsystem: simple
    build-commands:
      - pip3 install --prefix=${FLATPAK_DEST} .
      - install -Dm644 share/icons/${FLATPAK_ID}.svg ${FLATPAK_DEST}/share/icons/hicolor/scalable/apps/${FLATPAK_ID}.svg
      - install -Dm644 share/applications/${FLATPAK_ID}.desktop ${FLATPAK_DEST}/share/applications/${FLATPAK_ID}.desktop
      - install -Dm644 share/metainfo/${FLATPAK_ID}.appdata.xml ${FLATPAK_DEST}/share/metainfo/${FLATPAK_ID}.appdata.xml
    sources:
      - type: git
        url: https://github.com/rafatosta/zapzap.git
        tag: v1.1
      